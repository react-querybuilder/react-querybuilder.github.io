"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9346],{4015:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>u,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var s=t(24246),o=t(71670);const i={title:"Common mistakes",description:"How to resolve some frequently-reported issues",hide_table_of_contents:!0},r=void 0,c={id:"tips/common-mistakes",title:"Common mistakes",description:"How to resolve some frequently-reported issues",source:"@site/versioned_docs/version-5/tips/common-mistakes.mdx",sourceDirName:"tips",slug:"/tips/common-mistakes",permalink:"/docs/5/tips/common-mistakes",draft:!1,unlisted:!1,editUrl:"https://github.com/react-querybuilder/react-querybuilder/edit/main/website/versioned_docs/version-5/tips/common-mistakes.mdx",tags:[],version:"5",frontMatter:{title:"Common mistakes",description:"How to resolve some frequently-reported issues",hide_table_of_contents:!0},sidebar:"mySidebar",previous:{title:"Adding and removing query properties",permalink:"/docs/5/tips/adding-removing-query-properties"},next:{title:"Compatibility packages",permalink:"/docs/5/compat"}},a={},d=[{value:"Custom component as closure",id:"custom-component-as-closure",level:2}];function l(e){const n=Object.assign({h2:"h2",p:"p",a:"a",pre:"pre",code:"code",em:"em"},(0,o.a)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"custom-component-as-closure",children:"Custom component as closure"}),"\n",(0,s.jsxs)(n.p,{children:["When defining custom components for React Query Builder, ",(0,s.jsx)(n.a,{href:"https://react.dev/learn/your-first-component#nesting-and-organizing-components",children:"do not define them within the body of another function component"})," like this:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",metastring:'title="App.jsx"',children:"const App = () => {\n  // Other stuff ...\n\n  // highlight-start\n  const CustomValueEditor = props => {\n    // Custom logic here ...\n    return <input />;\n  };\n  // highlight-end\n\n  return (\n    <QueryBuilder\n      fields={fields}\n      query={query}\n      handleOnChange={q => setQuery(q)}\n      controlElements={{\n        valueEditor: CustomValueEditor,\n      }}\n    />\n  );\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This will almost certainly lead to undesirable behavior such as the value editor losing focus after each keystroke. This happens because the ",(0,s.jsx)(n.code,{children:"CustomValueEditor"})," component is being redefined each time the ",(0,s.jsx)(n.code,{children:"App"})," component renders. To fix the problem, move the custom component declaration outside of the other function component (it can still be in the same file, just not within the function body):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",metastring:'title="App.jsx"',children:"// highlight-start\nconst CustomValueEditor = props => {\n  // Custom logic here ...\n  return <input />;\n};\n// highlight-end\n\nconst App = () => {\n  // Other stuff ...\n\n  return (\n    <QueryBuilder\n      fields={fields}\n      query={query}\n      handleOnChange={q => setQuery(q)}\n      controlElements={{\n        valueEditor: CustomValueEditor,\n      }}\n    />\n  );\n};\n"})}),"\n",(0,s.jsxs)(n.p,{children:["A similar mistake that leads to the same problems is declaring arrow functions that render components inside the JSX syntax. In the code below, ",(0,s.jsx)(n.code,{children:"CustomValueEditor"})," is correctly defined outside the body of ",(0,s.jsx)(n.code,{children:"App"}),", but an arrow function that ",(0,s.jsx)(n.em,{children:"renders"})," ",(0,s.jsx)(n.code,{children:"CustomValueEditor"})," is assigned to ",(0,s.jsx)(n.code,{children:"valueEditor"})," instead of the ",(0,s.jsx)(n.code,{children:"CustomValueEditor"})," component itself. This causes a new function component to be created on every render."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",metastring:'title="App.jsx"',children:"const CustomValueEditor = props => {\n  // Custom logic here ...\n  return <input />;\n};\n\nconst App = () => {\n  // Other stuff ...\n\n  return (\n    <QueryBuilder\n      fields={fields}\n      query={query}\n      handleOnChange={q => setQuery(q)}\n      controlElements={{\n        // highlight-start\n        // Don't do this:\n        valueEditor: props => <CustomValueEditor {...props} />,\n        // Do this instead:\n        // valueEditor: CustomValueEditor,\n        // highlight-end\n      }}\n    />\n  );\n};\n"})})]})}const u=function(e={}){const{wrapper:n}=Object.assign({},(0,o.a)(),e.components);return n?(0,s.jsx)(n,Object.assign({},e,{children:(0,s.jsx)(l,e)})):l(e)}},71670:(e,n,t)=>{t.d(n,{a:()=>r});var s=t(27378);const o={},i=s.createContext(o);function r(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}}}]);