"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9534],{7009:(e,n,t)=>{t.d(n,{L:()=>a});var r=t(27378);const a=e=>{let{option:n,disabled:t=!1,text:a}=e;return r.createElement("a",{href:`/demo#${n}=${!t}`},a||"Click here for demo"+(t?" with this feature disabled":""))}},85971:(e,n,t)=>{t.d(n,{ZP:()=>l});var r=t(52685),a=(t(27378),t(35318));const o={toc:[]},i="wrapper";function l(e){let{components:n,...t}=e;return(0,a.kt)(i,(0,r.Z)({},o,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("em",{parentName:"p"},"Refer to the ",(0,a.kt)("a",{parentName:"em",href:"../typescript"},"TypeScript reference")," page for information about the types and interfaces referenced below."))))}l.isMDXComponent=!0},73305:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>l,default:()=>m,frontMatter:()=>i,metadata:()=>p,toc:()=>s});var r=t(52685),a=(t(27378),t(35318)),o=(t(7009),t(85971));const i={title:"Hooks",description:"Reuse React Query Builder's logic in your own components"},l=void 0,p={unversionedId:"utils/hooks",id:"utils/hooks",title:"Hooks",description:"Reuse React Query Builder's logic in your own components",source:"@site/docs/utils/hooks.mdx",sourceDirName:"utils",slug:"/utils/hooks",permalink:"/docs/next/utils/hooks",draft:!1,editUrl:"https://github.com/react-querybuilder/react-querybuilder/edit/main/website/docs/utils/hooks.mdx",tags:[],version:"current",frontMatter:{title:"Hooks",description:"Reuse React Query Builder's logic in your own components"},sidebar:"mySidebar",previous:{title:"Import",permalink:"/docs/next/utils/import"},next:{title:"Validation",permalink:"/docs/next/utils/validation"}},u={},s=[{value:"Component logic",id:"component-logic",level:2},{value:"<code>useQueryBuilder</code>",id:"usequerybuilder",level:3},{value:"<code>useRuleGroup</code>",id:"userulegroup",level:3},{value:"<code>useRule</code>",id:"userule",level:3},{value:"<code>useValueEditor</code>",id:"usevalueeditor",level:3},{value:"<code>useValueSelector</code>",id:"usevalueselector",level:3},{value:"<code>useSelectElementChangeHandler</code>",id:"useselectelementchangehandler",level:3},{value:"<code>useStopEventPropagation</code>",id:"usestopeventpropagation",level:3},{value:"Utilities",id:"utilities",level:2},{value:"<code>useMergedContext</code>",id:"usemergedcontext",level:3},{value:"<code>usePreferProp</code>",id:"usepreferprop",level:3},{value:"<code>usePrevious</code>",id:"useprevious",level:3},{value:"Internal",id:"internal",level:2},{value:"<code>useControlledOrUncontrolled</code>",id:"usecontrolledoruncontrolled",level:3},{value:"<code>useDeprecatedProps</code>",id:"usedeprecatedprops",level:3},{value:"<code>useReactDndWarning</code>",id:"usereactdndwarning",level:3}],d={toc:s},c="wrapper";function m(e){let{components:n,...t}=e;return(0,a.kt)(c,(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)(o.ZP,{mdxType:"TypeScriptAdmonition"}),(0,a.kt)("p",null,"These Hooks are used internally by React Query Builder."),(0,a.kt)("h2",{id:"component-logic"},"Component logic"),(0,a.kt)("p",null,"The core logic of each component is encapsulated in a reusable Hook. Each main component is itself little more than a call to its respective Hook and the JSX that utilizes the properties in the returned object. This enables the creation of one's own presentation layer without having to copy any code from the default components."),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"The ",(0,a.kt)("inlineCode",{parentName:"p"},"@react-querybuilder/native")," package is a good example of this concept. It calls the Hooks from its own query builder, rule group, and rule components, but nests the sub-components within React Native ",(0,a.kt)("inlineCode",{parentName:"p"},"View")," elements instead of HTML ",(0,a.kt)("inlineCode",{parentName:"p"},"div")," elements like the standard components.")),(0,a.kt)("h3",{id:"usequerybuilder"},(0,a.kt)("inlineCode",{parentName:"h3"},"useQueryBuilder")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"function useQueryBuilder(props: QueryBuilderProps): {\n  actions: QueryActions;\n  query: RuleGroupTypeAny;\n  queryDisabled: boolean;\n  rqbContext: ReturnType<typeof useMergedContext>;\n  schema: Schema;\n  translations: TranslationsFull;\n  wrapperClassName: string;\n};\n")),(0,a.kt)("p",null,"Used by the ",(0,a.kt)("a",{parentName:"p",href:"../components/querybuilder"},(0,a.kt)("inlineCode",{parentName:"a"},"QueryBuilder"))," component. Returns everything needed to render a wrapper element (e.g. ",(0,a.kt)("inlineCode",{parentName:"p"},"<div>"),") and the root ",(0,a.kt)("a",{parentName:"p",href:"../components/rulegroup"},(0,a.kt)("inlineCode",{parentName:"a"},"RuleGroup"))," element based on the provided props. Generates an ",(0,a.kt)("inlineCode",{parentName:"p"},"id")," for each rule and group in the query hierarchy that doesn't already have one."),(0,a.kt)("h3",{id:"userulegroup"},(0,a.kt)("inlineCode",{parentName:"h3"},"useRuleGroup")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"function useRuleGroup(props: RuleGroupProps): {\n  // See source code for returned properties:\n  // /packages/react-querybuilder/src/hooks/useRuleGroup.ts\n};\n")),(0,a.kt)("p",null,"Used by the ",(0,a.kt)("a",{parentName:"p",href:"../components/rulegroup"},(0,a.kt)("inlineCode",{parentName:"a"},"RuleGroup"))," component."),(0,a.kt)("h3",{id:"userule"},(0,a.kt)("inlineCode",{parentName:"h3"},"useRule")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"function useRule(props: RuleProps): {\n  // See source code for returned properties:\n  // /packages/react-querybuilder/src/hooks/useRule.ts\n};\n")),(0,a.kt)("p",null,"Used by the ",(0,a.kt)("a",{parentName:"p",href:"../components/rule"},(0,a.kt)("inlineCode",{parentName:"a"},"Rule"))," component."),(0,a.kt)("h3",{id:"usevalueeditor"},(0,a.kt)("inlineCode",{parentName:"h3"},"useValueEditor")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"function useValueEditor(\n  props: Pick<\n    ValueEditorProps,\n    | 'handleOnChange'\n    | 'inputType'\n    | 'operator'\n    | 'value'\n    | 'listsAsArrays'\n    | 'type'\n    | 'values'\n    | 'parseNumbers'\n    | 'skipHook'\n  >\n): { valueAsArray: any[]; multiValueHandler: (val: string, idx: number) => void };\n")),(0,a.kt)("p",null,"Used by the ",(0,a.kt)("a",{parentName:"p",href:"../components/valueeditor"},(0,a.kt)("inlineCode",{parentName:"a"},"ValueEditor"))," component. Accepts an object with a subset of ",(0,a.kt)("inlineCode",{parentName:"p"},"ValueEditorProps")," and returns the value as an array and a multi-value handler."),(0,a.kt)("p",null,"This Hook updates the ",(0,a.kt)("inlineCode",{parentName:"p"},"value")," as a side effect if the following conditions are true:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"skipHook")," is ",(0,a.kt)("inlineCode",{parentName:"li"},"false")," (the value editors in the ",(0,a.kt)("a",{parentName:"li",href:"../compat"},"compatibility packages")," set this to ",(0,a.kt)("inlineCode",{parentName:"li"},"true")," to avoid infinite loops)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"inputType")," is ",(0,a.kt)("inlineCode",{parentName:"li"},'"number"')),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"operator")," is something other than ",(0,a.kt)("inlineCode",{parentName:"li"},'"between"'),", ",(0,a.kt)("inlineCode",{parentName:"li"},'"notBetween"'),", ",(0,a.kt)("inlineCode",{parentName:"li"},'"in"'),", or ",(0,a.kt)("inlineCode",{parentName:"li"},'"notIn"')),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"value")," is an array or a string containing a comma (",(0,a.kt)("inlineCode",{parentName:"li"},","),").")),(0,a.kt)("p",null,"If all of those conditions are met, ",(0,a.kt)("inlineCode",{parentName:"p"},"handleOnChange")," will be called with the first element of the array or, if ",(0,a.kt)("inlineCode",{parentName:"p"},"value")," is a string, any characters before the first comma."),(0,a.kt)("h3",{id:"usevalueselector"},(0,a.kt)("inlineCode",{parentName:"h3"},"useValueSelector")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"function useValueSelector(\n  props: Pick<ValueSelectorProps, 'handleOnChange' | 'listsAsArrays' | 'multiple' | 'value'>\n): {\n  onChange: (v: string | string[]) => void;\n  val?: string | any[];\n};\n")),(0,a.kt)("p",null,"Used by the ",(0,a.kt)("a",{parentName:"p",href:"../components/valueselector"},(0,a.kt)("inlineCode",{parentName:"a"},"ValueSelector"))," component. Transforms the given value into an array when appropriate and provides a memoized change handler."),(0,a.kt)("h3",{id:"useselectelementchangehandler"},(0,a.kt)("inlineCode",{parentName:"h3"},"useSelectElementChangeHandler")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"function useSelectElementChangeHandler(props: {\n  multiple?: boolean;\n  onChange: (v: string | string[]) => void;\n}): (e: ChangeEvent<HTMLSelectElement>) => void;\n")),(0,a.kt)("p",null,"Used by the ",(0,a.kt)("a",{parentName:"p",href:"../components/valueselector"},(0,a.kt)("inlineCode",{parentName:"a"},"ValueSelector"))," component. Returns a memoized change handler specifically for HTML ",(0,a.kt)("inlineCode",{parentName:"p"},"<select />")," elements."),(0,a.kt)("h3",{id:"usestopeventpropagation"},(0,a.kt)("inlineCode",{parentName:"h3"},"useStopEventPropagation")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"function useStopEventPropagation(\n  methods: Record<string, (event: React.MouseEvent, context: any) => void>\n): Record<string, (event: React.MouseEvent, context: any) => void>;\n")),(0,a.kt)("p",null,"Used by the default ",(0,a.kt)("a",{parentName:"p",href:"../components/rule"},(0,a.kt)("inlineCode",{parentName:"a"},"Rule"))," and ",(0,a.kt)("a",{parentName:"p",href:"../components/rulegroup"},(0,a.kt)("inlineCode",{parentName:"a"},"RuleGroup"))," components to prevent default behavior and stop propagation of events (e.g., a ",(0,a.kt)("inlineCode",{parentName:"p"},"MouseEvent")," after clicking a ",(0,a.kt)("inlineCode",{parentName:"p"},"<button>"),"). Takes an object where the value of each key is a function taking ",(0,a.kt)("inlineCode",{parentName:"p"},"MouseEvent")," and context parameters; returns the same object with the respective functions having the same signature but calling ",(0,a.kt)("inlineCode",{parentName:"p"},"event.preventDefault()")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"event.stopPropagation()")," first."),(0,a.kt)("p",null,"This hook is ",(0,a.kt)("em",{parentName:"p"},"not")," used in the ",(0,a.kt)("inlineCode",{parentName:"p"},"Rule")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"RuleGroup")," components used/exported by ",(0,a.kt)("inlineCode",{parentName:"p"},"@react-querybuilder/native"),"."),(0,a.kt)("h2",{id:"utilities"},"Utilities"),(0,a.kt)("h3",{id:"usemergedcontext"},(0,a.kt)("inlineCode",{parentName:"h3"},"useMergedContext")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"function useMergedContext(\n  props: QueryBuilderContextProps & { translations: Translations }\n): QueryBuilderContextProps;\n")),(0,a.kt)("p",null,"Merges the values inherited from the nearest ancestor ",(0,a.kt)("inlineCode",{parentName:"p"},"QueryBuilderContext")," provider with the current component's props."),(0,a.kt)("h3",{id:"usepreferprop"},(0,a.kt)("inlineCode",{parentName:"h3"},"usePreferProp")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"function usePreferProp(default: boolean, prop?: boolean, context?: boolean): boolean;\n")),(0,a.kt)("p",null,"Given a default value, a prop value, and a context value (all ",(0,a.kt)("inlineCode",{parentName:"p"},"boolean")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"undefined"),"), returns the first one that is not ",(0,a.kt)("inlineCode",{parentName:"p"},"undefined")," in the order of (1) prop, (2) context, (3) default."),(0,a.kt)("h3",{id:"useprevious"},(0,a.kt)("inlineCode",{parentName:"h3"},"usePrevious")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"function usePrevious<T>(prop: T): T | null;\n")),(0,a.kt)("p",null,"Returns the value of a prop or state variable from the previous render."),(0,a.kt)("h2",{id:"internal"},"Internal"),(0,a.kt)("p",null,"These Hooks log error messages to the console in certain situations (in development mode only). They encourage correct usage of React Query Builder and are not intended to be used in custom components."),(0,a.kt)("h3",{id:"usecontrolledoruncontrolled"},(0,a.kt)("inlineCode",{parentName:"h3"},"useControlledOrUncontrolled")),(0,a.kt)("p",null,"Logs an error to the console if any of the following are true:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Both ",(0,a.kt)("inlineCode",{parentName:"li"},"query")," and ",(0,a.kt)("inlineCode",{parentName:"li"},"defaultQuery")," props are defined."),(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("inlineCode",{parentName:"li"},"query")," prop is defined during the first render and undefined in a subsequent render."),(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("inlineCode",{parentName:"li"},"query")," prop is undefined during the first render and defined in a subsequent render.")),(0,a.kt)("h3",{id:"usedeprecatedprops"},(0,a.kt)("inlineCode",{parentName:"h3"},"useDeprecatedProps")),(0,a.kt)("p",null,"Logs an error to the console if a ",(0,a.kt)("inlineCode",{parentName:"p"},"RuleGroup")," component is rendered with ",(0,a.kt)("inlineCode",{parentName:"p"},"combinator")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"rules")," props, or if a ",(0,a.kt)("inlineCode",{parentName:"p"},"Rule")," component is rendered with ",(0,a.kt)("inlineCode",{parentName:"p"},"field"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"operator"),", or ",(0,a.kt)("inlineCode",{parentName:"p"},"value")," props. These props are deprecated in favor of ",(0,a.kt)("inlineCode",{parentName:"p"},"ruleGroup")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"rule"),", respectively."),(0,a.kt)("h3",{id:"usereactdndwarning"},(0,a.kt)("inlineCode",{parentName:"h3"},"useReactDndWarning")),(0,a.kt)("p",null,"Logs an error to the console if the ",(0,a.kt)("inlineCode",{parentName:"p"},"enableDragAndDrop")," prop is ",(0,a.kt)("inlineCode",{parentName:"p"},"true")," but the ",(0,a.kt)("inlineCode",{parentName:"p"},"react-dnd")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"react-dnd-html5-backend")," dependencies are not loaded."))}m.isMDXComponent=!0},35318:(e,n,t)=>{t.d(n,{Zo:()=>s,kt:()=>k});var r=t(27378);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=r.createContext({}),u=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},s=function(e){var n=u(e.components);return r.createElement(p.Provider,{value:n},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),d=u(t),m=a,k=d["".concat(p,".").concat(m)]||d[m]||c[m]||o;return t?r.createElement(k,i(i({ref:n},s),{},{components:t})):r.createElement(k,i({ref:n},s))}));function k(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=m;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l[d]="string"==typeof e?e:a,i[1]=l;for(var u=2;u<o;u++)i[u]=t[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"}}]);