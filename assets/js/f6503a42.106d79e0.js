"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4310],{13520:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>u,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});var t=n(24246),a=n(71670),o=n(47050),i=n(37175);const l={title:"Migrating to v5",hide_table_of_contents:!0},c=void 0,s={id:"migrate",title:"Migrating to v5",description:"The transition from v4 to v5 should be fairly seemless. Core functionality has not been affected much since v4, other than a few bug fixes (see changelog). Significant code changes will only be necessary if you set the enableDragAndDrop prop to true and/or you use one of the compatibility packages.",source:"@site/versioned_docs/version-5/migrate.mdx",sourceDirName:".",slug:"/migrate",permalink:"/docs/5/migrate",draft:!1,unlisted:!1,editUrl:"https://github.com/react-querybuilder/react-querybuilder/edit/main/website/versioned_docs/version-5/migrate.mdx",tags:[],version:"5",frontMatter:{title:"Migrating to v5",hide_table_of_contents:!0},sidebar:"mySidebar",previous:{title:"UMD build",permalink:"/docs/5/umd"}},u={},d=[{value:"Drag-and-drop",id:"drag-and-drop",level:3},{value:"Compatibility packages",id:"compatibility-packages",level:3}];function p(e){const r={a:"a",admonition:"admonition",code:"code",em:"em",h3:"h3",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.p,{children:["The transition from v4 to v5 should be fairly seemless. Core functionality has not been affected much since v4, other than a few bug fixes (see ",(0,t.jsx)(r.a,{href:"https://github.com/react-querybuilder/react-querybuilder/blob/main/CHANGELOG.md",children:"changelog"}),"). Significant code changes will only be necessary if you set the ",(0,t.jsxs)(r.a,{href:"#drag-and-drop",children:[(0,t.jsx)(r.code,{children:"enableDragAndDrop"})," prop to ",(0,t.jsx)(r.code,{children:"true"})]})," and/or you use one of the ",(0,t.jsx)(r.a,{href:"#compatibility-packages",children:"compatibility packages"}),"."]}),"\n",(0,t.jsx)(r.h3,{id:"drag-and-drop",children:"Drag-and-drop"}),"\n",(0,t.jsx)(r.p,{children:"To enable drag-and-drop in v5, you'll need to make two changes."}),"\n",(0,t.jsxs)(r.p,{children:["First, install ",(0,t.jsx)(r.a,{href:"https://www.npmjs.com/package/react-dnd",children:(0,t.jsx)(r.code,{children:"react-dnd"})})," and ",(0,t.jsx)(r.a,{href:"https://www.npmjs.com/package/react-dnd-html5-backend",children:(0,t.jsx)(r.code,{children:"react-dnd-html5-backend"})})," explicitly, along with the companion package ",(0,t.jsx)(r.a,{href:"https://www.npmjs.com/package/@react-querybuilder/dnd",children:(0,t.jsx)(r.code,{children:"@react-querybuilder/dnd"})}),"."]}),"\n",(0,t.jsxs)(o.Z,{groupId:"npm2yarn",children:[(0,t.jsx)(i.Z,{value:"npm",children:(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"npm i react-dnd react-dnd-html5-backend @react-querybuilder/dnd\n"})})}),(0,t.jsx)(i.Z,{value:"Bun",children:(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"bun add react-dnd react-dnd-html5-backend @react-querybuilder/dnd\n"})})}),(0,t.jsx)(i.Z,{value:"yarn",label:"Yarn",children:(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"yarn add react-dnd react-dnd-html5-backend @react-querybuilder/dnd\n"})})}),(0,t.jsx)(i.Z,{value:"pnpm",label:"pnpm",children:(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"pnpm add react-dnd react-dnd-html5-backend @react-querybuilder/dnd\n"})})})]}),"\n",(0,t.jsxs)(r.p,{children:["Second, instead of setting the ",(0,t.jsx)(r.code,{children:"enableDragAndDrop"})," prop explicitly, wrap your ",(0,t.jsx)(r.code,{children:"<QueryBuilder />"})," element in ",(0,t.jsx)(r.code,{children:"<QueryBuilderDnD />"})," from ",(0,t.jsx)(r.code,{children:"@react-querybuilder/dnd"}),". This will automatically set ",(0,t.jsx)(r.code,{children:"enableDragAndDrop={true}"})," on ",(0,t.jsx)(r.code,{children:"<QueryBuilder />"}),"."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-diff",children:" export function App() {\n   return (\n-    <QueryBuilder enableDragAndDrop />\n+    <QueryBuilderDnD>\n+      <QueryBuilder />\n+    </QueryBuilderDnD>\n   );\n }\n"})}),"\n",(0,t.jsxs)(r.p,{children:["We also ",(0,t.jsx)(r.em,{children:"strongly"})," recommended passing all the exports from ",(0,t.jsx)(r.code,{children:"react-dnd"})," and ",(0,t.jsx)(r.code,{children:"react-dnd-html5-backend"})," in to ",(0,t.jsx)(r.code,{children:"<QueryBuilderDnD />"})," through its ",(0,t.jsx)(r.code,{children:"dnd"})," prop. Otherwise the query builder will initially be rendered with drag-and-drop disabled."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-tsx",children:"import { QueryBuilderDnD } from '@react-querybuilder/dnd';\n// highlight-start\nimport * as ReactDnD from 'react-dnd';\nimport * as ReactDndHtml5Backend from 'react-dnd-html5-backend';\n// highlight-end\nimport { QueryBuilder } from 'react-querybuilder';\n\nexport function App() {\n  return (\n    {/* highlight-start */}\n    <QueryBuilderDnD dnd={{ ...ReactDnD, ...ReactDndHtml5Backend }}>\n      {/* highlight-end */}\n      <QueryBuilder />\n    </QueryBuilderDnD>\n  );\n};\n"})}),"\n",(0,t.jsxs)(r.p,{children:["More information is available in the ",(0,t.jsx)(r.a,{href:"./api/querybuilder#enabledraganddrop",children:"full API documentation"}),"."]}),"\n",(0,t.jsx)(r.h3,{id:"compatibility-packages",children:"Compatibility packages"}),"\n",(0,t.jsxs)(r.p,{children:["The recommended implementation of ",(0,t.jsx)(r.a,{href:"./compat",children:"compatibility packages"})," has been simplified in v5. Instead of explicitly passing the replacement components in to the ",(0,t.jsx)(r.code,{children:"controlElements"})," prop, you can wrap the ",(0,t.jsx)(r.code,{children:"<QueryBuilder />"})," element in the appropriate ",(0,t.jsx)(r.code,{children:"<QueryBuilder* />"})," context provider that will automatically apply the correct ",(0,t.jsx)(r.code,{children:"controlElements"}),", ",(0,t.jsx)(r.code,{children:"controlClassnames"}),", and any other relevant props (now or in the future!). The example below uses the ",(0,t.jsx)(r.a,{href:"https://www.npmjs.com/package/@react-querybuilder/bootstrap",children:"Bootstrap-compatible package"}),"."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-diff",children:"-import {\n-  bootstrapControlClassnames,\n-  bootstrapControlElements\n-} from '@react-querybuilder/bootstrap';\n+import { QueryBuilderBootstrap } from '@react-querybuilder/bootstrap';\n import 'bootstrap-icons/font/bootstrap-icons.scss';\n import 'bootstrap/scss/bootstrap.scss';\n import { QueryBuilder } from 'react-querybuilder';\n\n export function App() {\n   return (\n-    <QueryBuilder\n-      controlClassnames={bootstrapControlClassnames}\n-      controlElements={bootstrapControlElements}\n-    />\n+    <QueryBuilderBootstrap>\n+      <QueryBuilder />\n+    </QueryBuilderBootstrap>\n   );\n };\n"})}),"\n",(0,t.jsx)(r.admonition,{type:"info",children:(0,t.jsxs)(r.p,{children:["See the ",(0,t.jsx)(r.a,{href:"./compat",children:"compatibility package documentation"})," for more information about specific packages, particularly ",(0,t.jsx)(r.code,{children:"@react-querybuilder/material"}),"."]})}),"\n",(0,t.jsxs)(r.p,{children:["Instructions on migrating from v3 to v4 are ",(0,t.jsx)(r.a,{href:"/docs/4/migrate",children:"here"}),"."]})]})}function h(e={}){const{wrapper:r}={...(0,a.a)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},37175:(e,r,n)=>{n.d(r,{Z:()=>i});var t=n(24246),a=(n(27378),n(18453));const o={tabItem:"tabItem_wHwb"};function i({children:e,hidden:r,className:n}){return(0,t.jsx)("div",{role:"tabpanel",className:(0,a.Z)(o.tabItem,n),hidden:r,children:e})}},47050:(e,r,n)=>{n.d(r,{Z:()=>B});var t=n(24246),a=n(27378),o=n(18453),i=n(30724),l=n(3620),c=n(51189),s=n(24349),u=n(17175),d=n(10092);function p(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function h(e,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):function(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})),e}function b(e){var r,n;return null!==(n=null===(r=a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})))||void 0===r?void 0:r.filter(Boolean))&&void 0!==n?n:[]}function m(e){const{values:r,children:n}=e;return(0,a.useMemo)((()=>{const e=null!=r?r:function(e){return b(e).map((({props:{value:e,label:r,attributes:n,default:t}})=>({value:e,label:r,attributes:n,default:t})))}(n);return function(e){const r=(0,u.l)(e,((e,r)=>e.value===r.value));if(r.length>0)throw new Error(`Docusaurus error: Duplicate values "${r.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[r,n])}function f({value:e,tabValues:r}){return r.some((r=>r.value===e))}function y({queryString:e=!1,groupId:r}){const n=(0,l.k6)(),t=function({queryString:e=!1,groupId:r}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=r?r:null}({queryString:e,groupId:r}),o=(0,s._X)(t),i=(0,a.useCallback)((e=>{if(!t)return;const r=new URLSearchParams(n.location.search);r.set(t,e),n.replace(h(function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){p(e,r,n[r])}))}return e}({},n.location),{search:r.toString()}))}),[t,n]);return[o,i]}function g(e){const{defaultValue:r,queryString:n=!1,groupId:t}=e,o=m(e),[i,l]=(0,a.useState)((()=>function({defaultValue:e,tabValues:r}){if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!f({value:e,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}var n;const t=null!==(n=r.find((e=>e.default)))&&void 0!==n?n:r[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:r,tabValues:o}))),[s,u]=y({queryString:n,groupId:t}),[p,h]=function({groupId:e}){const r=function(e){return e?`docusaurus.tab.${e}`:null}(e),[n,t]=(0,d.Nk)(r);return[n,(0,a.useCallback)((e=>{r&&t.set(e)}),[r,t])]}({groupId:t}),b=(()=>{const e=null!=s?s:p;return f({value:e,tabValues:o})?e:null})();(0,c.Z)((()=>{b&&l(b)}),[b]);return{selectedValue:i,selectValue:(0,a.useCallback)((e=>{if(!f({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),h(e)}),[u,h,o]),tabValues:o}}var j=n(30101);const x={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};function v(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function w(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){v(e,r,n[r])}))}return e}function O(e,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):function(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})),e}function k({className:e,block:r,selectedValue:n,selectValue:a,tabValues:l}){const c=[],{blockElementScrollPositionUntilNextRender:s}=(0,i.o5)(),u=e=>{const r=e.currentTarget,t=c.indexOf(r),o=l[t].value;o!==n&&(s(r),a(o))},d=e=>{let r=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=c.indexOf(e.currentTarget)+1;var n;r=null!==(n=c[t])&&void 0!==n?n:c[0];break}case"ArrowLeft":{const n=c.indexOf(e.currentTarget)-1;var t;r=null!==(t=c[n])&&void 0!==t?t:c[c.length-1];break}}null==r||r.focus()};return(0,t.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":r},e),children:l.map((({value:e,label:r,attributes:a})=>(0,t.jsx)("li",O(w({role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,ref:e=>c.push(e),onKeyDown:d,onClick:u},a),{className:(0,o.Z)("tabs__item",x.tabItem,null==a?void 0:a.className,{"tabs__item--active":n===e}),children:null!=r?r:e}),e)))})}function D({lazy:e,children:r,selectedValue:n}){const o=(Array.isArray(r)?r:[r]).filter(Boolean);if(e){const e=o.find((e=>e.props.value===n));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return(0,t.jsx)("div",{className:"margin-top--md",children:o.map(((e,r)=>(0,a.cloneElement)(e,{key:r,hidden:e.props.value!==n})))})}function q(e){const r=g(e);return(0,t.jsxs)("div",{className:(0,o.Z)("tabs-container",x.tabList),children:[(0,t.jsx)(k,w({},e,r)),(0,t.jsx)(D,w({},e,r))]})}function B(e){const r=(0,j.Z)();return(0,t.jsx)(q,O(w({},e),{children:b(e.children)}),String(r))}},71670:(e,r,n)=>{n.d(r,{Z:()=>l,a:()=>i});var t=n(27378);const a={},o=t.createContext(a);function i(e){const r=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(o.Provider,{value:r},e.children)}}}]);